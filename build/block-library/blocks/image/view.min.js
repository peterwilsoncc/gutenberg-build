(()=>{"use strict";const t=window.wp.interactivity;let e=!1,n=0;const{state:o,actions:i,callbacks:r}=(0,t.store)("core/image",{state:{currentImage:{},get overlayOpened(){return o.currentImage.currentSrc},get roleAttribute(){return o.overlayOpened?"dialog":null},get ariaModal(){return o.overlayOpened?"true":null},get enlargedSrc(){return o.currentImage.uploadedSrc||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},get imgStyles(){return o.overlayOpened&&`${o.currentImage.imgStyles?.replace(/;$/,"")}; object-fit:cover;`}},actions:{showLightbox(){const e=(0,t.getContext)();e.imageRef?.complete&&(o.scrollTopReset=document.documentElement.scrollTop,o.scrollLeftReset=document.documentElement.scrollLeft,e.currentSrc=e.imageRef.currentSrc,o.currentImage=e,o.overlayEnabled=!0,r.setOverlayStyles())},hideLightbox(){o.overlayEnabled&&(setTimeout((function(){o.currentImage.buttonRef.focus({preventScroll:!0}),o.currentImage={}}),450),o.showClosingAnimation=!0,o.overlayEnabled=!1)},handleKeydown(e){if(o.overlayEnabled){if("Tab"===e.key){e.preventDefault();const{ref:n}=(0,t.getElement)();n.querySelector("button").focus()}"Escape"===e.key&&i.hideLightbox()}},handleTouchMove(t){o.overlayEnabled&&t.preventDefault()},handleTouchStart(){e=!0},handleTouchEnd(){n=Date.now(),e=!1},handleScroll(){o.overlayOpened&&!e&&Date.now()-n>450&&window.scrollTo(o.scrollLeftReset,o.scrollTopReset)}},callbacks:{setOverlayStyles(){if(!o.currentImage.imageRef)return;let{naturalWidth:t,naturalHeight:e,offsetWidth:n,offsetHeight:i}=o.currentImage.imageRef,{x:r,y:l}=o.currentImage.imageRef.getBoundingClientRect();const a=t/e;let c=n/i;if("contain"===o.currentImage.scaleAttr)if(a>c){const t=n/a;l+=(i-t)/2,i=t}else{const t=i*a;r+=(n-t)/2,n=t}c=n/i;let g=parseFloat("none"!==o.currentImage.targetWidth?o.currentImage.targetWidth:t),s=parseFloat("none"!==o.currentImage.targetHeight?o.currentImage.targetHeight:e),u=g/s,d=g,m=s,h=g,f=s;if(a.toFixed(2)!==u.toFixed(2)){if(a>u){const t=g/a;s-t>g?(s=t,g=t*a):s=g/a}else{const t=s*a;g-t>s?(g=t,s=t/a):g=s*a}h=g,f=s,u=g/s,c>u?(d=g,m=d/c):(m=s,d=m*c)}(n>h||i>f)&&(h=n,f=i);let p=0;window.innerWidth>480?p=80:window.innerWidth>1920&&(p=160);const w=Math.min(window.innerWidth-p,h),y=Math.min(window.innerHeight-80,f);c>w/y?(h=w,f=h/c):(f=y,h=f*c);const b=n/h,x=g*(h/d),v=s*(f/m);o.overlayStyles=`\n\t\t\t\t:root {\n\t\t\t\t\t--wp--lightbox-initial-top-position: ${l}px;\n\t\t\t\t\t--wp--lightbox-initial-left-position: ${r}px;\n\t\t\t\t\t--wp--lightbox-container-width: ${h+1}px;\n\t\t\t\t\t--wp--lightbox-container-height: ${f+1}px;\n\t\t\t\t\t--wp--lightbox-image-width: ${x}px;\n\t\t\t\t\t--wp--lightbox-image-height: ${v}px;\n\t\t\t\t\t--wp--lightbox-scale: ${b};\n\t\t\t\t\t--wp--lightbox-scrollbar-width: ${window.innerWidth-document.documentElement.clientWidth}px;\n\t\t\t\t}\n\t\t\t`},setButtonStyles(){const e=(0,t.getContext)(),{ref:n}=(0,t.getElement)();e.imageRef=n;const{naturalWidth:o,naturalHeight:i,offsetWidth:r,offsetHeight:l}=n;if(0===o||0===i)return;const a=n.parentElement,c=n.parentElement.clientWidth;let g=n.parentElement.clientHeight;const s=a.querySelector("figcaption");if(s){const t=window.getComputedStyle(s);["absolute","fixed"].includes(t.position)||(g=g-s.offsetHeight-parseFloat(t.marginTop)-parseFloat(t.marginBottom))}const u=g-l,d=c-r;if("contain"===e.scaleAttr){const t=o/i;if(t>=r/l){const n=r/t;e.imageButtonTop=(l-n)/2+u+16,e.imageButtonRight=d+16}else{const n=l*t;e.imageButtonTop=u+16,e.imageButtonRight=(r-n)/2+d+16}}else e.imageButtonTop=u+16,e.imageButtonRight=d+16},setOverlayFocus(){if(o.overlayEnabled){const{ref:e}=(0,t.getElement)();e.focus()}},initTriggerButton(){const e=(0,t.getContext)(),{ref:n}=(0,t.getElement)();e.buttonRef=n}}},{lock:!0})})();
//# sourceMappingURL=view.min.js.map